# Tianole OS

Tianole OS 是一个从零开始编写的、用于学习和实践的简单32位操作系统内核。项目主要使用 C 语言和 x86 汇编实现，所有核心代码均包含丰富的中文注释，旨在打造一个对中文开发者友好、易于理解的操作系统学习平台。

当前项目正处于早期开发阶段，已经实现了一系列内核核心功能，但亟需社区的力量来共同完善，特别是用户态应用和程序的支持。我们非常欢迎对此感兴趣的同学和开发者加入我们，共同学习和成长！

## ✨ 当前已实现功能

通过分析代码，我们可以看到项目已经具备了坚实的基础：

- **引导与启动**: 支持 Multiboot 标准，可通过 GRUB 引导。
- **中断处理**: 完整的中断描述符表 (IDT) 和中断服务程序 (ISR) 设置，能够处理 CPU 异常和硬件中断(IRQ)。
- **内存管理**:
  - **分页机制**: 实现了页目录和页表的初始化，开启了虚拟内存管理。
  - **动态内存分配**: 实现了基于链表的内核堆 (kheap)，支持 `kmalloc` 和 `kfree`。
- **进程管理**:
  - **多任务处理**: 实现了基于循环链表的简单任务调度器 `schedule()`。
  - **进程创建与退出**: 实现了 `fork()`、`exit()` 和 `waitpid()` 系统调用。
- **驱动程序**:
  - 键盘、定时器(PIT)、串口(Serial Port)和 ATA 硬盘驱动的基础实现。
- **文件系统**:
  - 实现了 FAT16 文件系统的核心读写操作（`ls`, `mkdir`, `touch`, `write`, `cat`, `cd`等）。
- **交互式 Shell**:
  - 一个功能虽简但完备的内核态 Shell，支持命令历史、光标移动和基本的命令解析。

## 🚀 如何构建和运行

本项目依赖于 `gcc` (32位交叉编译工具链更佳), `nasm`, `ld`, `grub` 和 `qemu`。

1. 准备环境

   确保你已经安装了上述工具。在 Debian/Ubuntu 系统上，可以通过以下命令安装：

   ```bash
   sudo apt-get update
   sudo apt-get install build-essential nasm genisoimage qemu-system-i386
   ```

2. 创建硬盘镜像

   本项目使用一个虚拟硬盘镜像来测试FAT16文件系统。

   ```bash
   dd if=/dev/zero of=hdd.img bs=512 count=20480
   ```

3. 编译内核

   直接运行 make 即可编译所有源代码并生成内核文件 build/kernel.bin。

   ```bash
   make
   ```

4. 运行

   使用以下命令通过 QEMU 启动操作系统：

   ```bash
   make qemu-direct
   ```

   这个命令会直接加载内核，并将串口输出重定向到终端，方便调试。
   

### 🚩 主要贡献方向 (急需帮助！)

1. **用户态程序的加载与执行**
   - 这是当前项目的**首要任务**。我们希望能实现一个 `exec` 系统调用。
   - 需要设计一种可执行文件格式（如简单的 a.out 或 ELF 格式的子集）。
   - 编写代码加载器，能将文件内容从 FAT16 文件系统读入内存，并正确设置用户态进程的页表、栈和入口点。
   - 这是本项目从一个“内核”变成一个真正的“操作系统”的关键一步，非常有挑战性！
2. **完善文件系统**
   - 当前的 FAT16 实现还有很多可以改进的地方，例如：支持长文件名、跨簇的目录和文件、删除文件/目录等。
   - 性能优化，例如增加缓冲区缓存（Buffer Cache）。
3. **增加系统调用**
   - 增加更多的文件操作相关的系统调用，如 `read`, `write`, `open`, `close`。
   - 完善进程管理，如增加 `kill` 信号。
4. **构建一个用户态 C 库 (libc)**
   - 为了能方便地编写用户态程序，我们需要一个迷你的C标准库，至少包含 `printf`, `malloc` 等函数的封装，让它们通过系统调用与内核交互。

## 🤝 如何贡献

我们非常欢迎各种形式的贡献！你现在就可以通过以下方式帮助我们：

- **代码贡献**：请参考下面的“贡献方向”，选择你感兴趣的任务。
- **测试与 Bug 反馈**：运行内核，将你发现的任何问题通过 [GitHub Issues](https://www.google.com/search?q=https://github.com/microindole/tianole/issues) 告诉我们。
- **文档完善**：改进这份 `README` 或者为代码补充更清晰的注释。

你可以参考我们的 [**贡献指南 (CONTRIBUTING.md)**](./CONTRIBUTING.md) 来了解详细的贡献流程。

## 📞 联系与交流 (Contact & Communication)

我们鼓励所有与项目相关的技术讨论、Bug反馈和功能建议都通过 [**GitHub Issues**](https://github.com/microindole/tianole/issues) 进行。

**为什么我们强烈推荐使用 Issues？**

- **公开透明**：你的问题和解决方案可以帮助到社区里的其他人。
- **方便追踪**：我们可以更好地追踪每个问题的进展。
- **知识沉淀**：这里会成为项目宝贵的知识库。

**如果你有不适合公开讨论的敏感问题（例如安全漏洞报告），或者有其他的合作想法，可以通过以下方式联系作者：**

- **Email**:  [Microindole](mailto:microindole@gmail.com)

请注意，由于精力有限，技术相关的问题请**优先使用 Issues**，这样能保证更高质量的回复和更广泛的讨论。


## 📜 开源许可证

本项目采用 [木兰宽松许可证，第2版 (Mulan PSL v2)](./LICENSE)。